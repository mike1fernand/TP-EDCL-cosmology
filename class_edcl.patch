--- a/include/background.h
+++ b/include/background.h
@@ -200,6 +200,7 @@ struct background
   int index_bg_rho_ur;
   int index_bg_p_ur;
   int index_bg_rho_cdm;
+  int index_bg_rho_edcl;  /* EDCL density scaling factor */
   int index_bg_rho_b;
   int index_bg_rho_g;
   int index_bg_p_g;
@@ -300,6 +301,7 @@ struct background
   double Omega0_ur;
   double Omega0_cdm;
   double Omega0_b;
+  double Omega0_edcl;     /* EDCL Omega at a=1 */
   double Omega0_g;
   double T_cmb;
   double Omega0_k;
@@ -400,6 +401,8 @@ struct background
   double w0_fld;
   double wa_fld;
   double cs2_fld;
+  double w0_edcl;         /* EDCL w0 CPL */
+  double wa_edcl;         /* EDCL wa CPL */
--- a/source/input.c
+++ b/source/input.c
@@ -1500,6 +1500,11 @@ int input_read_parameters(
   class_read_double("Omega_cdm",pba->Omega0_cdm);
   class_read_double("Omega_b",pba->Omega0_b);
   class_read_double("Omega_ur",pba->Omega0_ur);
+  class_read_double("Omega_edcl",pba->Omega0_edcl);
+  class_read_double("w0_edcl",pba->w0_edcl);
+  class_read_double("wa_edcl",pba->wa_edcl);
+
   class_read_double("Omega_k",pba->Omega0_k);
   class_read_double("Omega_fld",pba->Omega0_scf);
--- a/source/background.c
+++ b/source/background.c
@@ -500,6 +500,7 @@ int background_init(
   pba->index_bg_rho_ur = ...;
   pba->index_bg_p_ur = ...;
   pba->index_bg_rho_cdm = ...;
+  pba->index_bg_rho_edcl = ppt->index_md_scalars * pba->bg_size + pba->index_bg_rho_edcl;
   pba->index_bg_rho_b = ...;
@@ -510,6 +511,7 @@ int background_init(
   pba->bt_size = ...;
   pba->bt_size = pba->index_bi_rho_cdm + 1;
   pba->bt_size = pba->index_bi_rho_b + 1;
+  pba->bt_size = pba->index_bi_rho_edcl + 1;  /* Increase ODE size for EDCL rho scaling factor */
   pba->bt_size = ...;
--- a/source/background.c
+++ b/source/background.c
@@ -1200,6 +1200,7 @@ int background_functions(
   pvecback[pba->index_bg_rho_rad] = ...;
   pvecback[pba->index_bg_p_rad] = ...;
   pvecback[pba->index_bg_rho_cdm] = ...;
+  pvecback[pba->index_bg_rho_edcl] = y[pba->index_bi_rho_edcl];  /* Assign from integrated state y[] */
   pvecback[pba->index_bg_rho_b] = ...;
@@ -1210,6 +1211,13 @@ int background_functions(
   pvecback[pba->index_bg_p_fld] = ...;
+
+  /* Derive p_edcl from w(a) and rho_edcl (not integrated) */
+  double rho_edcl = pvecback[pba->index_bg_rho_edcl];  /* From y[] */
+
+  double w_edcl = pba->w0_edcl + pba->wa_edcl * (1.0 - a);
+  pvecback[pba->index_bg_p_edcl] = w_edcl * rho_edcl;
 
   /* ... */
@@ -1500,6 +1508,9 @@ int background_derivs(
   yprime[pba->index_bi_rho_cdm + ipt] = ...;
 }

+/* EDCL continuity (conserved fluid) */
+yprime[pba->index_bi_rho_edcl] = -3.0 * (a_prime / a) * (pvecback[pba->index_bg_rho_edcl] + pvecback[pba->index_bg_p_edcl]);
+
 /* ... */
